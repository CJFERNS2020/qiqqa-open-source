<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      Qiqqa Internals :: Processing PDF documents&#39; text and the impact on
      UI+UX | Qiqqa / VuePress
    </title>
    <meta name="description" content="Documentation in its infancy..." />
    <meta name="generator" content="VuePress 1.4.0" />
    <link
      rel="icon"
      href="./favicon.ico"
    />
    <link
      rel="preload"
      href="./assets/css/0.styles.95439d49.css"
      as="style"
    />
    <link
      rel="stylesheet"
      href="./assets/css/0.styles.95439d49.css"
    />
  </head>
  <body>
    <div id="app" data-server-rendered="true">
      <div class="theme-container">
        <header class="navbar">
          <div class="sidebar-button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
              role="img"
              viewBox="0 0 448 512"
              class="icon"
            >
              <path
                fill="currentColor"
                d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"
              ></path>
            </svg>
          </div>
          <a
            href="./"
            class="home-link router-link-active"
            ><img
              src="./assets/img/image001.d0f5.png"
              alt="Qiqqa / VuePress"
              class="logo"
            />
            <span class="site-name can-hide">Qiqqa / VuePress</span></a
          >
          <div class="links">
            <nav class="nav-links can-hide">
              <div class="nav-item">
                <a
                  href="./"
                  class="nav-link"
                >
                  Home
                </a>
              </div>
              <div class="nav-item">
                <a
                  href="./The.Qiqqa.Manual.html"
                  class="nav-link"
                >
                  Guide
                </a>
              </div>
              <div class="nav-item">
                <a
                  href="https://google.com/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="nav-link external"
                >
                  External
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                    x="0px"
                    y="0px"
                    viewBox="0 0 100 100"
                    width="15"
                    height="15"
                    class="icon outbound"
                  >
                    <path
                      fill="currentColor"
                      d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                    ></path>
                    <polygon
                      fill="currentColor"
                      points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                    ></polygon></svg
                ></a>
              </div>
              <div class="nav-item">
                <div class="dropdown-wrapper">
                  <button
                    type="button"
                    aria-label="Language Menu"
                    class="dropdown-title"
                  >
                    <span class="title">Languages</span>
                    <span class="arrow right"></span>
                  </button>
                  <ul class="nav-dropdown" style="display: none;">
                    <li class="dropdown-item">
                      <a
                        href="./language/chinese/"
                        class="nav-link"
                      >
                        Chinese
                      </a>
                    </li>
                    <li class="dropdown-item">
                      <a
                        href="./language/dutch/"
                        class="nav-link"
                      >
                        Dutch
                      </a>
                    </li>
                    <li class="dropdown-item">
                      <a
                        href="./"
                        class="nav-link"
                      >
                        English
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <a
                href="https://github.com/jimmejardine/qiqqa-open-source"
                target="_blank"
                rel="noopener noreferrer"
                class="repo-link"
              >
                Contribute!
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                  x="0px"
                  y="0px"
                  viewBox="0 0 100 100"
                  width="15"
                  height="15"
                  class="icon outbound"
                >
                  <path
                    fill="currentColor"
                    d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                  ></path>
                  <polygon
                    fill="currentColor"
                    points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                  ></polygon></svg
              ></a>
            </nav>
          </div>
        </header>
        <div class="sidebar-mask"></div>
        <aside class="sidebar">
          <nav class="nav-links">
            <div class="nav-item">
              <a
                href="./"
                class="nav-link"
              >
                Home
              </a>
            </div>
            <div class="nav-item">
              <a
                href="./The.Qiqqa.Manual.html"
                class="nav-link"
              >
                Guide
              </a>
            </div>
            <div class="nav-item">
              <a
                href="https://google.com/"
                target="_blank"
                rel="noopener noreferrer"
                class="nav-link external"
              >
                External
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                  x="0px"
                  y="0px"
                  viewBox="0 0 100 100"
                  width="15"
                  height="15"
                  class="icon outbound"
                >
                  <path
                    fill="currentColor"
                    d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                  ></path>
                  <polygon
                    fill="currentColor"
                    points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                  ></polygon></svg
              ></a>
            </div>
            <div class="nav-item">
              <div class="dropdown-wrapper">
                <button
                  type="button"
                  aria-label="Language Menu"
                  class="dropdown-title"
                >
                  <span class="title">Languages</span>
                  <span class="arrow right"></span>
                </button>
                <ul class="nav-dropdown" style="display: none;">
                  <li class="dropdown-item">
                    <a
                      href="./language/chinese/"
                      class="nav-link"
                    >
                      Chinese
                    </a>
                  </li>
                  <li class="dropdown-item">
                    <a
                      href="./language/dutch/"
                      class="nav-link"
                    >
                      Dutch
                    </a>
                  </li>
                  <li class="dropdown-item">
                    <a
                      href="./"
                      class="nav-link"
                    >
                      English
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <a
              href="https://github.com/jimmejardine/qiqqa-open-source"
              target="_blank"
              rel="noopener noreferrer"
              class="repo-link"
            >
              Contribute!
              <svg
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
                x="0px"
                y="0px"
                viewBox="0 0 100 100"
                width="15"
                height="15"
                class="icon outbound"
              >
                <path
                  fill="currentColor"
                  d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                ></path>
                <polygon
                  fill="currentColor"
                  points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                ></polygon></svg
            ></a>
          </nav>
          <ul class="sidebar-links">
            <li>
              <section class="sidebar-group depth-0">
                <p class="sidebar-heading open">
                  <span
                    >Qiqqa Internals :: Processing PDF documents' text and the
                    impact on UI+UX</span
                  >
                </p>
                <ul class="sidebar-links sidebar-group-items">
                  <li>
                    <a
                      href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#how-does-qiqqa-obtain-this-ocr-text"
                      class="sidebar-link"
                      >How does Qiqqa obtain this OCR text?</a
                    >
                    <ul class="sidebar-sub-headers">
                      <li class="sidebar-sub-header">
                        <a
                          href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#text-extraction"
                          class="sidebar-link"
                          >Text Extraction</a
                        >
                      </li>
                      <li class="sidebar-sub-header">
                        <a
                          href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#text-recognition"
                          class="sidebar-link"
                          >Text Recognition</a
                        >
                      </li>
                      <li class="sidebar-sub-header">
                        <a
                          href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#how-does-this-impact-ux"
                          class="sidebar-link"
                          >How does this impact UX?</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a
                      href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#performance"
                      class="sidebar-link"
                      >Performance</a
                    >
                    <ul class="sidebar-sub-headers">
                      <li class="sidebar-sub-header">
                        <a
                          href="./Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.html#now-back-on-topic"
                          class="sidebar-link"
                          >Now back on topic</a
                        >
                      </li>
                    </ul>
                  </li>
                </ul>
              </section>
            </li>
          </ul>
        </aside>
        <main class="page">
          <div class="theme-default-content content__default">
            <h1
              id="qiqqa-internals-processing-pdf-documents-text-and-the-impact-on-ui-ux"
            >
              <a
                href="#qiqqa-internals-processing-pdf-documents-text-and-the-impact-on-ui-ux"
                class="header-anchor"
                >#</a
              >
              Qiqqa Internals :: Processing PDF documents’ text and the impact
              on UI+UX
            </h1>
            <blockquote>
              <p>
                Rippeed off from my reply to
                <a
                  href="https://github.com/jimmejardine/qiqqa-open-source/issues/165"
                  target="_blank"
                  rel="noopener noreferrer"
                  >https://github.com/jimmejardine/qiqqa-open-source/issues/165<svg
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                    x="0px"
                    y="0px"
                    viewBox="0 0 100 100"
                    width="15"
                    height="15"
                    class="icon outbound"
                  >
                    <path
                      fill="currentColor"
                      d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                    ></path>
                    <polygon
                      fill="currentColor"
                      points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                    ></polygon></svg
                ></a>
              </p>
            </blockquote>
            <p>
              Had a look at what happened exactly. It has been enlightening as I
              discovered I was working with a couple of internal assumptions
              that are clearly based on developer rather than user experience
              influencing my user experience.
            </p>
            <h1 id="what-is-going-on">
              <a href="#what-is-going-on" class="header-anchor">#</a> What is
              going on?
            </h1>
            <p>
              When Qiqqa imports the PDF into the library, a few things happen
              under the hood:
            </p>
            <ul>
              <li>
                a queued background task will attempt to
                <em>infer</em> metadata, such as author, from the PDF metadata.
              </li>
              <li>
                other <em>inferred</em> metadata, e.g. <em>title</em> and
                <em>abstract</em>, is obtained by going through the
                <em>OCR text</em> of the PDF.
              </li>
            </ul>
            <p>
              Both of these ‘trigger’ a request to fetch the document text, i.e.
              the <em>OCR text</em>.
            </p>
            <h1 id="what-is-ocr-text-in-this-context">
              <a href="#what-is-ocr-text-in-this-context" class="header-anchor"
                >#</a
              >
              What <em>is</em> “OCR text” (in this context)?
            </h1>
            <p>
              Qiqqa “OCR text” is the <em>word text</em> plus location rectangle
              coordinates collection extracted from the PDF by the
              <em>OCR background process</em>. Think of it as each word
              <strong>plus</strong> its precise position on the page, stored in
              a Qiqqa proprietary ocr file format.
            </p>
            <h2 id="how-does-qiqqa-obtain-this-ocr-text">
              <a
                href="#how-does-qiqqa-obtain-this-ocr-text"
                class="header-anchor"
                >#</a
              >
              How does Qiqqa obtain this <em>OCR text</em>?
            </h2>
            <p>
              That’s where some confusion can occur: Qiqqa has two methods to
              extract text from a PDF.
              <strong
                >It does not matter which of these methods has produced that
                text content</strong
              >: either way it’s stored in the “Qiqqa OCR text cache”.
            </p>
            <h3 id="text-extraction">
              <a href="#text-extraction" class="header-anchor">#</a> Text
              <em>Extraction</em>
            </h3>
            <p>
              The <strong>primary</strong> method is
              <strong>direct text extraction</strong>: using the
              <code>mupdf</code> tool, Qiqqa can get the text (plus coordinates)
              for any PDF which has a text layer embedded.
            </p>
            <p>
              <strong
                >Your sample PDF is entirely processed by this first method, all
                69 pages of it.</strong
              >
            </p>
            <h3 id="text-recognition">
              <a href="#text-recognition" class="header-anchor">#</a> Text
              <em>Recognition</em>
            </h3>
            <p>
              When the primary method fails to deliver a text for a given page,
              that page is then <em>re-queued</em> to have it OCR-ed using a
              Tesseract-based subprocess. This is the
              <strong>secondary</strong> method for obtaining the text of a
              document (page).
            </p>
            <h1 id="how-does-this-impact-ux">
              <a href="#how-does-this-impact-ux" class="header-anchor">#</a> How
              does this impact UX?
            </h1>
            <p>
              As long as Qiqqa does <em>not</em> have the PDF text available in
              its cache, it will <em>disable</em> any user activity that needs
              this data:
            </p>
            <ul>
              <li>
                <strong>text selection</strong> for copy &amp; paste,
                export-to-Word and similar purposes
              </li>
              <li>
                <strong>highlight text</strong> annotating text by marking it
                using a selection process.
              </li>
              <li>…</li>
            </ul>
            <p>
              The background tasks mentioned before (inferring metadata) are
              <em>postponed</em> until the <em>OCR text</em> is available.
            </p>
            <p>
              There a few more background tasks which have not been mentioned
              yet, including the one <em>updating the text search index</em>:
              that task of course requires the <em>OCR text</em> as well.
            </p>
            <p>
              From a user perspective, one can say that text searching in Qiqqa
              will only pick up on the new documents after <em>both</em> the OCR
              process (methods 1 or 2, whatever it took to get some text out of
              those new PDFs) <em>and</em> the background Lucene text search
              indexing process have processed the new PDF documents.
            </p>
            <h2 id="performance">
              <a href="#performance" class="header-anchor">#</a> Performance
            </h2>
            <p>
              Qiqqa <em>may</em> seem to be ‘slow’ in picking up new imported
              PDFs as the above processes all happen in the background and are
              currently set up to load the CPU only <em>moderately</em>: this
              was specifically done to make Qiqqa cope much better with large
              &amp; <em>huge</em> libraries filled with technical datasheets and
              other PDF documents, which caused all sorts of trouble, including
              UI lockups and application crashes. (In commercial Qiqqa this
              included fatal crashes, where the application was unwilling to
              start up again and/or fatal loss of the text search index.)
            </p>
            <p>
              Yes, we still have a way to go before Qiqqa will be fast and
              responsive as the current drive was first to make Qiqqa stable in
              such a ‘large library’ environment. To make Qiqqa behave well and
              <em>responsive</em> in various environments, it will take quite
              some more effort.
            </p>
            <h1 id="now-back-on-topic">
              <a href="#now-back-on-topic" class="header-anchor">#</a> Now back
              on topic
            </h1>
            <p>
              Now we have a description of what goes on and an observed run, I
              can address the issue at hand:
            </p>
            <ul>
              <li>
                <p>
                  as described above, Qiqqa will take some time before it runs
                  and completes the new document(s) text extraction and then
                  allow text marking and selecting actions. Up till that moment
                  those user activities are disallowed.
                </p>
                <p>
                  Hence these activities should be possible after some patience
                  has been exercised. (Unless the PDF is one of the crappy sort,
                  causing the “OCR” methods trouble, which is yet another
                  chapter. 😉 )
                </p>
              </li>
            </ul>
            <p>
              My initial confusion was due to me thinking in Qiqqa
              <em>coding</em> terms: both text <em>extraction</em> and
              <em>recognition</em> are filed under the single title of “OCR-ing
              the text”, because that’s how Qiqqa approaches this under the
              hood.
            </p>
            <hr />
            <blockquote>
              <p>
                To complicate matters further, there’s also a couple of options
                to <em>freeze</em> the OCR/text extraction and/or
                <em>all background processes</em>. Suffice to say those options
                (in the Qiqqa Tools menu and Qiqqa Configuration window) are
                <strong>not active</strong> unless the user has activated them
                (e.g. a developer or power user testing Qiqqa or importing a
                large set of documents). The use of these options is out of
                scope.
              </p>
            </blockquote>
          </div>
          <footer class="page-edit">
            <div class="edit-link">
              <a
                href="https://github.com/jimmejardine/qiqqa-open-source/edit/master/docs/Qiqqa.Internals.-.Processing.PDF.documents'.text.and.the.impact.on.UI+UX.md"
                target="_blank"
                rel="noopener noreferrer"
                >Help us improve this page!</a
              >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
                x="0px"
                y="0px"
                viewBox="0 0 100 100"
                width="15"
                height="15"
                class="icon outbound"
              >
                <path
                  fill="currentColor"
                  d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"
                ></path>
                <polygon
                  fill="currentColor"
                  points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"
                ></polygon>
              </svg>
            </div>
            <div class="last-updated">
              <span class="prefix">Last Updated:</span>
              <span class="time">4/2/2020, 11:57:22 PM</span>
            </div>
          </footer>
        </main>
      </div>
      <div class="global-ui"></div>
    </div>
  </body>
</html>